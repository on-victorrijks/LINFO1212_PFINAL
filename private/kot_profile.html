<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>{{page.title}}</title>
  <meta name="description" content="{{page.description}}">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="/css/vars.css">
  <link rel="stylesheet" href="/css/global.css">
  <link rel="stylesheet" href="/css/menu.css">
  <link rel="stylesheet" href="/css/kot_profile.css">
  <link rel="stylesheet" href="/css/footer.css">

</head>
<body>

    <div class="menuContainer">
        <div class="fixedBtn" id="mobileOpen">
            <img src="/imgs/icons/menu_black_24dp.svg" alt="logo"/>
        </div>
        <div class="fixedBtn" id="mobileClose" hidden="true">
            <img src="/imgs/icons/close_black_24dp.svg" alt="logo"/>
        </div>
    
        <div class="menu" id="menu" mobileHidden="true">
    
            <div class="menuElms">
    
                <div class="menuTopElements">
                    <a class="logo" href="/">
                        <img src="/imgs/logo.svg" id="logo_long" alt="logo"/>
                        <img src="/imgs/logo_mini.svg" id="logo_mini" alt="logo_mini"/>
                    </a>
                    {{#user}}
                    <a class="user" href="/account">
                        <div class="userImage">
                            <img src="https://localhost:8080/users/profilPicture/{{user._id}}" alt="user"/>
                        </div>
                        <div class="userText">
                            <h1>{{user.firstname}} {{user.lastname}}</h1>
                            <h2>Mon compte</h2>
                        </div>
                    </a>
                    {{/user}}
                    {{^user}}
                    <a class="registerorlogin" href="/login">
                        <h1>Se connecter / S'inscrire</h1>
                    </a>
                    {{/user}}
                </div>
                <div class="menuOptions">
    
                    <a class="option" selected="{{menu.selectedPage.home}}" href="/">
                        <div class="optionImage">
                            <img id="unselected" alt="menuOption" src="/imgs/icons/search_black_24dp.svg"/>
                            <img id="selected"   alt="menuOption" src="/imgs/icons/search_black_24dp_selected.svg"/>
                        </div>
                        <div class="optionName">
                            <h2>Accueil</h2>
                        </div>
                    </a>

                    {{#user}}
                    <a class="option" selected="{{menu.selectedPage.conversations}}" href="/conversations">
                        <div class="optionImage">
                            <img id="unselected" alt="menuOption" src="/imgs/icons/question_answer_black_24dp.svg"/>
                            <img id="selected"   alt="menuOption" src="/imgs/icons/question_answer_black_24dp_selected.svg"/>
                        </div>
                        <div class="optionName">
                            <h2>Messages</h2>
                        </div>
                    </a>
                    {{/user}}
                    {{^user}}
                    <a class="option" selected="{{menu.selectedPage.presentation}}" href="/presentation">
                        <div class="optionImage">
                            <img id="unselected" alt="menuOption" src="/imgs/icons/view_module_black_24dp.svg"/>
                            <img id="selected"   alt="menuOption" src="/imgs/icons/view_module_black_24dp_selected.svg"/>
                        </div>
                        <div class="optionName">
                            <h2>Présentation</h2>
                        </div>
                    </a>
                    {{/user}}
                    
                    {{#user}}
                    {{#user.isResident}}
                    <a class="option" selected="{{menu.selectedPage.favs}}" href="/kot/favs">
                        <div class="optionImage">
                            <img id="unselected" alt="menuOption" src="/imgs/icons/favorite_black_24dp.svg"/>
                            <img id="selected"   alt="menuOption" src="/imgs/icons/favorite_black_24dp_selected.svg"/>
                        </div>
                        <div class="optionName">
                            <h2>Mes favoris</h2>
                        </div>
                    </a>
                    
                    {{/user.isResident}}
                    {{/user}}

                    {{#user}}
                    {{#user.isLandlord}}
                    <a class="option" selected="{{menu.selectedPage.publish}}" href="/kot/create">
                        <div class="optionImage">
                            <img id="unselected" alt="menuOption" src="/imgs/icons/add_black_24dp.svg"/>
                            <img id="selected"   alt="menuOption" src="/imgs/icons/add_black_24dp_selected.svg"/>
                        </div>
                        <div class="optionName">
                            <h2>Publier un kot</h2>
                        </div>
                    </a>
                    <a class="option" selected="{{menu.selectedPage.mykots}}" href="/kot/my">
                        <div class="optionImage">
                            <img id="unselected" alt="menuOption" src="/imgs/icons/home_black_24dp.svg"/>
                            <img id="selected"   alt="menuOption" src="/imgs/icons/home_black_24dp_selected.svg"/>
                        </div>
                        <div class="optionName">
                            <h2>Mes kots</h2>
                        </div>
                    </a>
                    {{/user.isLandlord}}
                    {{/user}}
    
                    <a class="option" selected="{{menu.selectedPage.contact}}" href="/contact">
                        <div class="optionImage">
                            <img id="unselected" alt="menuOption" src="/imgs/icons/call_black_24dp.svg"/>
                            <img id="selected"   alt="menuOption" src="/imgs/icons/call_black_24dp_selected.svg"/>
                        </div>
                        <div class="optionName">
                            <h2>Contact</h2>
                        </div>
                    </a>
    
                </div>
                
                {{#user}}
                <div class="notificationsTab" hidden id="notificationsTab">
                    <div class="title">
                        <h1>Notifications</h1>
                        <button onClick="switchNotificationsTabVisibility()">
                            <img src="/imgs/icons/close_black_24dp.svg"/>
                        </button>
                    </div>
                    <div class="notificationsContainer" id="notificationsContainer">

                        <div class="notifBlocker"></div>

                    </div>
                </div>
                {{/user}}

                {{#user}}
                <div class="otherBtns">
                    <button id="showNotificationsTab" onClick="switchNotificationsTabVisibility()">
                        <div class="notifIndicator" id="notifIndicator"></div>
                        <img src="/imgs/icons/notifications_black_24dp.svg" alt="notifications"/>
                    </button>
                    <a href="/account/settings">
                        <img src="/imgs/icons/settings_black_24dp.svg" alt="settings"/>
                    </a>
                    <a href="/disconnect">
                        <img src="/imgs/icons/logout_black_24dp.svg" alt="disconnect"/>
                    </a>
                </div>
                {{/user}}
            </div>
            
        </div>
    </div>

    <div class="g-background bgColor">

        <div class="g-content">

            <input type="hidden" id="kot_localisation_lat" value="{{kot.location.lat}}"/>
            <input type="hidden" id="kot_localisation_lng" value="{{kot.location.lng}}"/>
            <input type="hidden" id="kotID" value="{{kot._id}}"/>

            <div class="g-topBar">
                <a class="g-topTitle" href="/search">
                    <img src="/imgs/icons/arrow_back_ios_black_24dp.svg" alt="back_arrow">
                    <h1>Retourner à la recherche</h1>
                </a>
                <div class="g-topIcons">
                    <button id="share">
                        <img src="/imgs/icons/ios_share_black_24dp.svg" alt="share">
                    </button>
                </div>
            </div>

            <div class="columnsContainer">
                <div class="kotInfos">

                    <div class="carrousel">
                        {{#kot.pictures}}
                        <img alt="carrouselImage" id="carrouselImage{{index}}" main="{{isMainImage}}" src="https://localhost:8080/users/kots/images/{{kot._id}}_{{imageName}}">
                        {{/kot.pictures}}
                        <div class="controls">
                            {{#kot.pictures}}
                            <div class="bubble" id="carrouselBubble{{index}}" selected="{{isMainImage}}" onClick="setCarrouselImage({{index}})"></div>
                            {{/kot.pictures}}
                        </div>
                        {{#user}}
                        <button class="favBtn" id="fav" onClick="switchFav()" inFavs="false">
                            <img id="fav_true" src="/imgs/icons/favorite_black_24dp_selected.svg" alt="share">
                            <img id="fav_false" src="/imgs/icons/favorite_border_black_24dp.svg" alt="share">
                        </button>
                        {{/user}}
                    </div>  

                    <div class="informationsContainer">
                        <div class="mainInformations">
                            <h1>{{kot.title}}</h1>
                            <h2>{{kot.location.address}}</h2>
                        </div>
                        <div class="sideInformations">
                            <h2>{{kot.basePrice}}€</h2>
                            <h3>+ {{kot.chargePrice}}€</h3>
                        </div>
                    </div>

                    <h1 class="infosLabel">Description</h1>
                    <div class="descriptionContainer">
                        <p>
                            {{kot.description}}
                        </p>
                    </div>

                    <h1 class="infosLabel">Voir sur la carte</h1>
                    <div class="mapShower">
                        <div id="map"></div>
                    </div>

                    <h1 class="infosLabel">Autres informations</h1>
                    <div class="otherInformations">
                        <div class="infosColumn">

                            <h2>Spécifications du batîment</h2>
                            <div class="infoRow">
                                <img alt="" src="/imgs/icons/bedroom_parent_black_24dp.svg">
                                <h3>{{kot.bedrooms}} chambre(s)</h3>
                            </div>
                            <div class="infoRow">
                                <img alt="" src="/imgs/icons/bathroom_black_24dp.svg">
                                <h3>{{kot.bathrooms}} salle(s) de bain</h3>
                            </div>
                            <div class="infoRow">
                                <img alt="" src="/imgs/icons/wc_black_24dp.svg">
                                <h3>{{kot.toilets}} toilette(s)</h3>
                            </div>
                            <div class="infoRow">
                                <img alt="" src="/imgs/icons/maps_home_work_black_24dp.svg">
                                <h3>Type du batîment : {{kot.type}}</h3>
                            </div>
                            <div class="infoRow">
                                <img alt="" src="/imgs/icons/square_foot_black_24dp.svg">
                                <h3>Surface : {{kot.surface}}m²</h3>
                            </div>
                            <div class="infoRow">
                                <img alt="" src="/imgs/icons/house_siding_black_24dp.svg">
                                <h3>{{kot.floors}} étage(s)</h3>
                            </div>
                            <div class="infoRow">
                                <img alt="" src="/imgs/icons/construction_black_24dp.svg">
                                <h3>Année de construction : {{kot.constructionYear}}</h3>
                            </div>

                            <div class="spacer"></div>

                            <h2>Autres</h2>
                            <div class="infoRow">
                                <img alt="" src="/imgs/icons/lock_open_black_24dp.svg">
                                <h3>Kot habitable dés le : {{kot.availability}}</h3>
                            </div>
                            <div class="infoRow">
                                <img alt="" src="/imgs/icons/chair_black_24dp.svg">
                                <h3>
                                    {{#kot.furnished}}
                                    Ce kot est meublé
                                    {{/kot.furnished}}
                                    {{^kot.furnished}}
                                    Ce kot n'est pas meublé
                                    {{/kot.furnished}}
                                </h3>
                            </div>
                            <div class="infoRow">
                                <img alt="" src="/imgs/icons/pets_black_24dp.svg">
                                <h3>{{kot.petFriendly}}</h3>
                            </div>

                        </div>
                        <div class="infosColumn">

                            <h2>Informations sur la collocation</h2>
                            <div class="infoRow">
                                <img alt="" src="/imgs/icons/groups_black_24dp.svg">
                                <h3>
                                    {{#kot.isCollocation}}
                                    Ce kot est une collocation
                                    {{/kot.isCollocation}}
                                    {{^kot.isCollocation}}
                                    Ce kot n'est pas une collocation
                                    {{/kot.isCollocation}}
                                </h3>
                            </div>
                            {{#kot.isCollocation}}
                            <div class="infoRow">
                                <img alt="" src="/imgs/icons/person_add_black_24dp.svg">
                                <h3>{{kot.collocationData.tenantsID.length}}/{{kot.collocationData.maxTenant}} colocataire(s) trouvé(s)</h3>
                            </div>
                            {{/kot.isCollocation}}

                            <div class="spacer"></div>

                            <h2>Informations sur l'éxtérieur</h2>
                            <div class="infoRow">
                                <img alt="" src="/imgs/icons/local_parking_black_24dp.svg">
                                <h3>{{kot.parking}} place(s) de parking</h3>
                            </div>
                            <div class="infoRow">
                                <img alt="" src="/imgs/icons/yard_black_24dp.svg">
                                <h3>
                                    {{#kot.garden}}
                                    Présence d'un jardin
                                    {{/kot.garden}}
                                    {{^kot.garden}}
                                    Pas de jardin
                                    {{/kot.garden}}
                                </h3>
                            </div>
                            <div class="infoRow">
                                <img alt="" src="/imgs/icons/deck_black_24dp.svg">
                                <h3>
                                    {{#kot.terrace}}
                                    Présence d'une terrace
                                    {{/kot.terrace}}
                                    {{^kot.terrace}}
                                    Pas de terrace
                                    {{/kot.terrace}}
                                </h3>
                            </div>

                        </div>
                    </div>
                    
                </div>

                <div class="sideInfos">
                    <div class="creatorBox">
                            <div class="creatorProfilPicContainer">
                                <div class="creatorProfilPic">
                                    <img alt="creator_profilPic" src="https://localhost:8080/users/profilPicture/{{creatorData._id}}"/>
                                </div>
                            </div>
                            <div class="creatorInfos">
                                <h1>{{creatorData.firstname}} {{creatorData.lastname}}</h1>
                                <h3>(+32) {{creatorData.phonenumber}}</h3>
                                <h3>{{creatorData.email}}</h3>
                            </div>
                    </div>
                    <div class="tagsAndButtonsContainer">
                            <a href="/user/{{creatorData._id}}">Voir le profil</a>
    
                            {{#isConnectedUserTheCreator}}
                            <div class="tags-separator"></div>
                            <a href="/kot/modify/{{kot._id}}">Modifier le kot</a>
                            {{/isConnectedUserTheCreator}}
                            {{^isConnectedUserTheCreator}}
                            {{#user}}
                            <div class="tags-separator"></div>
                            <a href="/api/conversations/create/fromkot/{{kot._id}}/{{kot.creatorID}}">Envoyer un message</a>
                            {{/user}}
                            {{/isConnectedUserTheCreator}}
                            
                            {{#kot.availability}}
                            <div class="tags-separator"></div>
                            <div class="tag">
                                <img alt="dispo_icon" src="/imgs/icons/done_black_24dp.svg"/>
                                <h2>Kot disponible</h2>
                            </div>
                            {{/kot.availability}}
                            {{^kot.availability}}
                            <div class="tags-separator"></div>
                            <div class="tag">
                                <img alt="dispo_icon" src="/imgs/icons/close_black_24dp.svg"/>
                                <h2>Kot non-disponible</h2>
                            </div>
                            {{/kot.availability}}
    
                            {{#kot.hasBeenModified}}
                            <div class="tags-separator"></div>
                            <div class="tag">
                                <img alt="dispo_icon" src="/imgs/icons/edit_black_24dp.svg"/>
                                <h2>Annonce modifiée</h2>
                            </div>
                            {{/kot.hasBeenModified}}
    
                    </div>

                    {{#isConnectedUserTheCreator}}
                    {{/isConnectedUserTheCreator}}
                    {{^isConnectedUserTheCreator}}
                        {{#kot.isCollocation}}
                        <div class="collocation-box">
                            <h3>{{kot.collocationData.tenantsID.length}}/{{kot.collocationData.maxTenant}} colocataire(s) trouvé(s)</h3>
                            {{#kot.canJoinCollocation}}
                                {{#user}}
                                    <button class="joinCollocation" onClick="askToJoinCollocation()" id="askToJoinCollocation" visible="true">Demander à rejoindre</a>
                                    <button class="joinCollocation cancel" onClick="cancelAskToJoinCollocation()" id="cancelAskToJoinCollocation" visible="false">Annuler la demande à rejoindre</a>
                                {{/user}}
                                {{^user}}
                                    <button disabled type="button" class="disabled">Vous devez être connecté pour rejoindre cette colocation</a>
                                {{/user}}
                            {{/kot.canJoinCollocation}}
                            {{^kot.canJoinCollocation}}
                                <button disabled type="button" class="disabled">Colocation remplie</a>
                            {{/kot.canJoinCollocation}}
                        </div>
                        {{/kot.isCollocation}}
                    {{/isConnectedUserTheCreator}}
                    
                </div>



            </div>
                
        </div>

    </div>

</body>
<script src="/js/kot_profile.js"></script>
<script
  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBvHIznYCzznbkXRcZOt4MuvKxthkGcaSU&callback=initMap&libraries=&v=weekly"
  async
></script>
<script src="/js/menu.js"></script>
{{#user}}
<script src="/js/notificationsManager.js"></script>
{{/user}}
